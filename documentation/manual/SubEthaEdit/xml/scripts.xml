<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter SYSTEM "../../etc/documentation.dtd">
<chapter name="Scripts" id="scripts" edition_le="no">
	<paragraph edition_le="no" edition_se="no">Unlike DEVONthink Professional, ${software} does
	not come with AppleScript abilities.</paragraph>
	<paragraph edition_le="no" edition_se="no">To conveniently "print" documents as PDFs to
	your ${software} database, simply add an alias to the ${software} application to the
	directory "~/Library/PDF Services". This does not give you the option to choose the name of
	the "printed" file as well as the destination group but creates a PDF of the "printed"
	document and adds this to ${software}. For full PDF Services and AppleScript support please
	have a look at 
	<reference chapter="otherproducts" section="devonthink">DEVONthink
	Professional.</reference></paragraph>
	<paragraph edition_le="no" edition_pe="no">${software} comes with a fully loaded
	AppleScript dictionary that allows you to automate almost every aspect of the application.
	Use the included (useful!) scripts and Automator actions to perform seldom-used functions
	and as templates to create your own scripts and workflows.</paragraph>
	<section name="Introduction" id="intro" edition_le="no" edition_pe="no">
		<paragraph>${software} features one of the largest AppleScript dictionaries of all
		Mac OS X applications available that makes it possible to automate nearly every
		aspect of the application and to integrate it with almost every other application
		supporting AppleScript.</paragraph>
		<subsection name="Example Scripts" id="intro_examples">
			<paragraph>To make it easier for you to start with scripting right away, we
			deliver a whole bunch of scripts with ${software} that you can simply use
			from the 
			<reference chapter="menus" section="scripts">"Scripts"
			menu</reference>(which shows a stylized "S" symbol as its title instead of
			the word "Scripts"). These scripts interact directly with a selected group
			or document, or create documents themselves. All scripts delivered with
			${software} are also useable for day to day work, not simple examples
			skeletons that need to be filled with life first.</paragraph>
			<paragraph>Other ways to use AppleScript for extending and integrating
			${software} are triggered scripts, folder actions, droplets and PDF
			Services scripts. You'll find descriptions of the scripts that come with
			${software} in the corresponding sections of this chapter.</paragraph>
		</subsection>
		<subsection name="The Global Script Menu" id="intro_menuextra">
			<paragraph>Mac OS X's global script menu allows you to access scripts from
			any application. When activated, it appears at the right hand side of the
			menu bar like other menu extra. It also appears with a graphic "S"
			icon.</paragraph>
			<note>By using folders named after applications inside the
			"~/Library/Scripts/Applications" directory it's also possible to make
			scripts application-specific. Such scripts will appear at the top level of
			the global script menu when the application they belong to is frontmost.
			This removes clutter and shows only scripts that make sense in the current
			application.</note>
			<paragraph>${software} already comes with a couple of scripts that you can
			access very conveniently from the global script menu. ${software} asks to
			install them whenever you update the application, or you can (re-)install
			them manually by selecting 
			<reference chapter="menus" section="help" subsection="help_addons">"Help
			&gt; Install Add-ons...".</reference>They will be installed in
			"~/Library/Scripts" and so only apply for the user currently logged
			in.</paragraph>
			<paragraph>To activate the global script menu, do the
			following:</paragraph>
			<list>
				<item>Open the AppleScript Utility (in
				"/Applications/AppleScript").</item>
				<item>Check "Show Script Menu in menu bar".</item>
				<item>Uncheck "Show Library scripts" if you only want to see the
				scripts you've installed yourself.</item>
			</list>
			<note>On Mac OS X 10.3.9, use "/Utilities/AppleScript/Install Script Menu"
			instead of the AppleScript Utility.</note>
			<paragraph>To install your own scripts, e.g. the scripts that come with
			${software}, copy them into the folder "~/Library/Scripts". You can use
			subfolders to structure them in any way you like.</paragraph>
		</subsection>
		<subsection name="${software}'s Dictionary" id="intro_dictionary">
			<paragraph>${software} includes a large dictionary with commands, objects
			and methods you can use for writing scripts that interact or extend
			${software}. To view the dictionary, open the Script Editor application (by
			default in "/Applications/AppleScript"), select "File &gt; Open
			Dictionary..." and choose ${software} in the appearing window.</paragraph>
			<paragraph>You can also add ${software} to your Script Editor library.
			Select "Window &gt; Library", click the "+" button and choose ${software}.
			This way you have ${software}'s dictionary always handy.</paragraph>
		</subsection>
		<subsection name="Learning AppleScript" id="intro_learningapplescript">
			<paragraph>This documentation is no AppleScript language guide. Please
			refer to 
			<link href="http://www.apple.com/applescript">Apple's AppleScript web
			site,</link>other online resources or introduction and reference books.
			Here are some links for you:</paragraph>
			<list>
				<item>
					<link href="http://www.apple.com/macosx/features/applescript/resources.html">
					Mac OS X AppleScript Resources Page</link>
				</item>
				<item>
					<link href="http://macscripter.net">MacScripter</link>
				</item>
				<item>
					<link href="http://www.scriptweb.org">ScriptWeb</link>
				</item>
			</list>
			<list>
				<item>
					<link href="http://www.tecsoft.com/ascourse.html">TECsoft
					Hands-On Trainings</link>
				</item>
				<item>
					<link href="http://www.scriptingmatters.com">Scripting
					Matters Trainings</link>
				</item>
			</list>
			<list>
				<item>
					<link href="http://www.applescriptsourcebook.com/tips/AS4AS/AS4ASb2.pdf">
					AppleScript for Absolute Starters (free PDF book)</link>
				</item>
				<item>
					<link href="http://www.amazon.com/exec/obidos/tg/detail/-/0596008503/qid=1121266897/sr=8-1/ref=pd_bbs_ur_1/002-5709247-5091254?v=glance&amp;s=books&amp;n=507846">
					AppleScript: The Missing Manual</link>
				</item>
				<item>
					<link href="http://www.amazon.com/exec/obidos/tg/detail/-/0596005571/qid=1121266897/sr=8-2/ref=pd_bbs_ur_2/002-5709247-5091254?v=glance&amp;s=books&amp;n=507846">
					AppleScript: The Definitive Guide</link>
				</item>
			</list>
		</subsection>
	</section>
	<section name="${software}'s Scripts Menu" id="scriptsmenu" edition_le="no"
	edition_pe="no">
		<paragraph>The internal scripts menu of ${software}, located to the left of the
		Help menu (in ${software}'s menu bar), gives you access to a large number of
		pre-made scripts and 
		<reference chapter="scripts" section="automator">Automator
		workflows</reference>that extend ${software} with additional, more specialized
		commands and functions.</paragraph>
		<paragraph>Of course, you can easily modify all these scripts using AppleScript
		Editor and the workflows using Automator or add your own scripts and workflows to
		the menu. They are located in "~/Library/Application Support/DEVONthink Pro", you
		can open this folder in the Finder comfortably with "Scripts &gt; Open Scripts
		Folder".</paragraph>
		<note>If you have modified the contents of the script menu and you want to go back
		to the default set, delete the complete "DEVONthink Pro" folder in
		"~/Library/Application Support". ${software} will recreate this folder including
		it's contents when you open it the next time.</note>
		<subsection name="Address Book &amp; Mail" id="scriptsmenu_addressbook">
			<list>
				<item name="Import Phone List">Imports all phone numbers from Apple
				Address Book.</item>
				<item name="Reply to">Creates an e-mail with the contents of the
				current document in your default e-mail application.</item>
			</list>
		</subsection>
		<subsection name="Comments" id="scriptsmenu_comments">
			<list>
				<item name="Assemble">Collects the comments of the selected
				documents and creates a new document listing them.</item>
				<item name="Speak">Speaks the comments of the selected
				documents.</item>
			</list>
		</subsection>
		<subsection name="Data" id="scriptsmenu_data">
			<list>
				<item name="Find &amp; Remove Similar Contents">Finds and removes
				similar documents.</item>
				<item name="Group With Duplicates">Creates a group with duplicates
				of the selected documents.</item>
				<item name="Group With Replicants">Creates a group with replicants
				of the selected documents.</item>
				<item name="Show recommended groups">Shows the groups recommended
				by ${software}'s AI for the selected document.</item>
			</list>
		</subsection>
		<subsection name="Dates" id="scriptsmenu_dates">
			<list>
				<item name="Creation &gt; Modification Date">Sets the modification
				date of the selected item(s) to their creation dates.</item>
				<item name="Modification &gt; Creation Date">Sets the creation date
				of the selected item(s) to their modification dates.</item>
				<item name="Touch Creation Date">Sets the creation date and time of
				the selected item(s) to the current date and time.</item>
			</list>
		</subsection>
		<subsection name="Download" id="scriptsmenu_download">
			<list>
				<item name="Images of Page">Adds the images of a displayed web page
				to the database.</item>
				<item name="Linked Images of Page">Adds linked images of a
				displayed web page to the database.</item>
				<item name="Links of Page">Adds links contained on a displayed web
				page to the database.</item>
				<item name="Create Offline Archive">Creates an offline version of a
				displayed web page.</item>
			</list>
		</subsection>
		<subsection name="Edit" id="scriptsmenu_edit">
			<list>
				<item name="Count Characters">Counts the characters in the current
				selection.</item>
				<item name="Count Words">Counts the words in the current
				selection.</item>
			</list>
		</subsection>
		<subsection name="Execute" id="scriptsmenu_execute">
			<list>
				<item name="AppleScript">Executes an AppleScript script.</item>
				<item name="Perl">Executes a Perl script.</item>
				<item name="Shell">Executes a shell script.</item>
			</list>
		</subsection>
		<subsection name="Export" id="scriptsmenu_export">
			<paragraph>The following scripts provide some more seldom-used export
			functions and help you create backups of your database for copying them to
			external media such as CD-R or the iDisk.</paragraph>
			<list>
				<item name="Listing...">Saves a UTF-8 text file containing a text
				listing of the names of all contents/groups of the current
				database.</item>
				<item name="Daily Backup">Creates a backup of the database.</item>
				<item name="Backup Archive...">Creates a backup of the database at
				a chosen location, e.g. the Desktop, and makes it a Zip archive
				that can be comfortably copied to an external medium, the iDisk or
				a CD-R.</item>
				<item name="Send To ...">Sends the current document via e-mail
				using the Mac OS X mail framework.</item>
				<item name="Send Selected Text To ...">Sends the selected text via
				e-mail using the Mac OS X mail framework.</item>
			</list>
		</subsection>
		<subsection name="Feeds" id="scriptsmenu_feeds">
			<paragraph>${software} is not an RSS reader in the first place, but can
			serve as such. The following scripts implement some automatic RSS functions
			such as downloading of new articles and marking already read articles by
			changing their labels. All functions are implemented by using triggered
			scripts, so they may also serve as good examples on how to use triggered
			scripts for automating ${software}.</paragraph>
			<list>
				<item name="Apple -- Hot News">Creates an HTML document with
				Apple's Hot News.</item>
				<item name="Apple -- Latest Mac OS X downloads">Creates a groups
				with links to recommended downloads.</item>
				<item name="Nature -- Hubble News">Downloads the latest Hubble
				news.</item>
				<item name="iTMS -- Added Albums">Downloads covers of albums
				recently added to the iTMS.</item>
				<item name="Mark as read / unread">Marks / unmarks selected
				documents, for use with downloaded RSS feeds.</item>
				<item name="New Feed (HTML / Linked)">Downloads an RSS feed and
				stores each news item as a separate document.</item>
				<item name="Synchronize (HTML / Linked)">Syncs a group with RSS
				items with its online counterpart.</item>
			</list>
		</subsection>
		<subsection name="Format" id="scriptsmenu_format">
			<list>
				<item name="Body Normal">Formats selected text as "Body
				Normal".</item>
				<item name="Body Small">Formats selected text as "Body
				Small".</item>
				<item name="Header Capitalized">Formats selected text as "Header
				Capitalized".</item>
				<item name="Header Normal">Formats selected text as "Header
				Normal".</item>
				<item name="Header Secondary">Formats selected text as "Header
				Secondary".</item>
				<item name="Source">Formats selected text as "Source".</item>
				<item name="Reset Spacing">Resets the line and paragraph spacing of
				selected rich text.</item>
			</list>
		</subsection>
		<subsection name="Images" id="scriptsmenu_images">
			<list>
				<item name="Copy Info to Comment">Copies basic image info to the
				comment field.</item>
				<item name="Flip Horizontal / Vertical">Flips the image
				horizontally / vertically.</item>
				<item name="Rotate Left / Right">Rotates the image left /
				right.</item>
				<item name="Landscape to Portrait">Rotates only landscape images to
				portrait.</item>
				<item name="Portrait to Landscape">Rotates only portrait images to
				landscape.</item>
				<item name="Scale to 1024 pixels wide">Scales the image to 1,024
				pixels wide.</item>
				<item name="Scale to 1024 pixels">Scales the image to 1,024
				pixels.</item>
				<item name="Scale to 200%">Scales the image to 200 percent.</item>
				<item name="Scale to 50%">Scales the image to 50 percent.</item>
			</list>
		</subsection>
		<subsection name="Import" id="scriptsmenu_import">
			<paragraph>These scripts demonstrate ${software}'s ability to import data
			from various sources including web sites.</paragraph>
			<list>
				<item name="Astronomy Picture of the Day">Imports the Astronomy
				Picture of the Day.</item>
				<item name="Daily Dilbert">Imports the Daily Dilbert.</item>
				<item name="Man Page...">Imports a UNIX manual page.</item>
				<item name="Mars Explorer Rover Mission Im.">Imports Mars Explorer
				Rover Mission Images.</item>
				<item name="Perldoc...">Imports the documentation of Perl pages,
				modules, functions or programs.</item>
				<item name="This week's MacDesktops">Imports this week's
				MacDesktops.</item>
			</list>
		</subsection>
		<subsection name="Path &amp; URL" id="scriptsmenu_pathurl">
			<paragraph>The following scripts assist you by dealing with the "Path" and
			"URL" fields and can help fixing problems.</paragraph>
			<list>
				<item name="Remove Paths...">Clears the "Path" field of selected
				documents.</item>
				<item name="Remove URL...">Clears the "URL" field of selected
				documents.</item>
				<item name="Rename Files &amp; Folders...">Renames external files
				according to the document names.</item>
				<item name="Update Paths...">Changes the "Path" of selected
				documents.</item>
			</list>
		</subsection>
		<subsection name="Rename" id="scriptsmenu_rename">
			<list>
				<item name="Add Prefix...">Adds a prefix to the names of selected
				documents.</item>
				<item name="Add Suffix...">Adds a suffix to the names of selected
				documents.</item>
				<item name="Replace Text...">Replaces a text passage in the names
				of selected documents.</item>
				<item name="To Web Page Title">Sets the document name to the name
				of the web page pointed to by the "URL" field.</item>
			</list>
		</subsection>
		<subsection name="Sheets" id="scriptsmenu_sheets">
			<paragraph>Even though ${software} is no spreadsheet application but a
			database, these scripts implement basic sum and mean value functionality
			for sheets.</paragraph>
			<list>
				<item name="Add Multiple Records...">Adds up to 999 empty records
				to a sheet.</item>
				<item name="Column Sum &amp; Mean Value">Calculates the sum and
				average of a table column.</item>
				<item name="Row Sum &amp; Mean Value">Calculates the sum and
				average of a table row.</item>
				<item name="Check sums in last column">Checks the sums in the last
				column on validity.</item>
			</list>
		</subsection>
		<subsection name="Smart Group" id="scriptsmenu_smartgroup">
			<paragraph>These scripts use triggered AppleScripts to create basic "smart
			groups", groups that adapt their contents to a given query. The scripts
			dynamically fill the group they're attached to with replicants of all
			documents that match their query.</paragraph>
			<list>
				<item name="All Words (Checked)">Creates a smart group (folder with
				attached triggered AppleScript) for all documents containing given
				words and status "checked".</item>
				<item name="All Words (Unchecked)">Creates a smart group (folder
				with attached triggered AppleScript) for all documents containing
				given words and status "unchecked".</item>
				<item name="All Words">Creates a smart group (folder with attached
				triggered AppleScript) for all documents containing all given
				words.</item>
				<item name="Any Words">Creates a smart group (folder with attached
				triggered AppleScript) for all documents containing a least one of
				the given words.</item>
				<item name="Label">Creates a smart group (folder with attached
				triggered AppleScript) for all documents with a given label.</item>
				<item name="Delete">Removes the attached triggered script from a
				smart group.</item>
			</list>
		</subsection>
		<subsection name="Thumbnails" id="scriptsmenu_thumbnails">
			<list>
				<item name="Flip Horizontal / Vertical">Flips the thumbnails of
				selected documents horizontally / vertically.</item>
				<item name="Rotate Left / Right">Rotates the thumbnails of selected
				documents left / right.</item>
				<item name="Landscape to Portrait">Rotates only landscape
				thumbnails to portrait.</item>
				<item name="Portrait to Landscape">Rotates only portrait thumbnails
				to landscape.</item>
			</list>
		</subsection>
		<subsection name="Translate" id="scriptsmenu_translate">
			<list>
				<item name="English to German">Translates selected text using 
				<link href="http://dict.leo.org">dict.leo.org.</link></item>
				<item name="German to English">Translates selected text using 
				<link href="http://dict.leo.org">dict.leo.org.</link></item>
			</list>
		</subsection>
		<subsection name="About this Menu" id="scriptsmenu_about">
			<paragraph>Shows an information dialog window with a short explanation
			about what the menu is for.</paragraph>
		</subsection>
	</section>
	<section name="Global Script Menu" id="scriptmenuextra" edition_le="no" edition_pe="no">
		<paragraph>AppleScript is perfectly suited for integrating different applications,
		interchanging information and for creating workflows. ${software} comes with
		various scripts that copy information from other applications like Safari or Mail
		to ${software} and that you can use as a template for connecting ${software} to
		your own applications.</paragraph>
		<paragraph>To install these scripts completely automatically, select 
		<reference chapter="menus" section="help" subsection="help_addons">"Help &gt;
		Install Add-ons...",</reference>check "Application Scripts", "DEVONthink Pro
		Scripts" and click "Install".</paragraph>
		<note>The application-specific scripts (put into subfolders of
		"~/Library/Scripts/Applications") appear only within the application they're
		designed for 
		<reference chapter="scripts" section="intro">(see introduction).</reference>The
		other scripts are located in a submenu named "DEVONthink Pro".</note>
		<subsection name="DEVONagent, OmniWeb and Safari" id="scriptmenuextra_browser">
			<paragraph>These scripts import elements from a displayed web page in
			Safari, OmniWeb or 
			<reference chapter="otherproducts" section="devonagent">
			DEVONagent</reference>to the currently open ${software}
			database.</paragraph>
			<list>
				<item>Add page to DEVONthink (not available for OmniWeb)</item>
				<item>Add image to DEVONthink</item>
				<item>Add linked images to DEVONthink</item>
				<item>Add linked images to DEVONthink's downloads</item>
				<item>Add links to DEVONthink</item>
				<item>Add links to DEVONthink's downloads</item>
				<item>Add selection to DEVONthink</item>
				<item>Add text to DEVONthink (not available for OmniWeb)</item>
				<item>Add webarchive to DEVONthink (Safari, only)</item>
			</list>
			<paragraph>The scripts add the currently displayed page or image, the
			selection or the text of the current page, the linked images of the current
			thumbnail gallery or the links of the current page from Safari or
			DEVONagent to ${software} or its download manager.</paragraph>
		</subsection>
		<subsection name="E-Mail Applications" id="scriptmenuextra_email">
			<paragraph>As Apple provided Mail with a proprietary drag-and-drop
			protocol, the only clean way to copy complete messages from Mail to
			${software} is AppleScript (you can, of course, transfer selected text to
			${software} at any time using the 
			<reference chapter="menus" section="services">"Services"
			menu).</reference>${software} comes with scripts for these e-mail
			applications:</paragraph>
			<list>
				<item>Apple Mail</item>
				<item>
					<link href="http://www.barebones.com">Barebones
					Mailsmith</link>
				</item>
				<item>
					<link href="http://www.microsoft.com/mac">Microsoft
					Entourage</link>
				</item>
				<item>
					<link href="http://www.ctmdev.com">Powermail</link>
				</item>
				<item>
					<link href="http://www.eudora.com">Qualcomm Eudora</link>
				</item>
			</list>
			<paragraph>These scripts, all named "Add message(s) to DEVONthink" and
			located in the appropriate subfolder for their target application, copy
			selected messages from Apple Mail, Microsoft Entourage, Eudora or Barebones
			Mailsmith to the currently open ${software} database. If possible, they set
			the creation/modification date of the imported messages to the receipt date
			and the "URL" field to the sender's address.</paragraph>
			<paragraph>For Apple Mail and Microsoft Entourage, also "Add mailbox(es) to
			DEVONthink" scripts are available that import complete mailboxes. Both
			scripts also recursively import mailboxes inside the selected mailboxes and
			rebuild the mailbox hierarchy within a group named "Entourage Mail" or
			"Apple Mail" in the currently open ${software} database.</paragraph>
			<note>To make the Entourage script available in Office's own script menu
			and not only the system-wide one, move the script into the folder
			"~/Documents/Microsoft User Data/Entourage Script Menu Items".</note>
			<note>To make the Apple Mail script available in Mail's own script menu
			(Mac OS X 10.3.x Panther only!), copy it into the folder
			"~/Library/Scripts/Mail Scripts".</note>
		</subsection>
		<subsection name="RSS Newsreader" id="scriptmenuextra_rss">
			<paragraph>These scripts, namely "Add news to DEVONthink" allow you to add
			selected news from 
			<link href="http://ranchero.com/netnewswire">NetNewsWire</link>and 
			<link href="http://kula.jp/software/endo/">Endo</link>to the currently open
			${software} database. If correctly installed (see above), select any news
			you want to copy to your database and select the script from the global
			script menu extra.</paragraph>
		</subsection>
		<subsection name="Other Scripts" id="scriptmenuextra_other">
			<paragraph>The remaining scripts designed for the script menu extra allow
			you to copy selected text to your database or to create a link to the
			frontmost document. They're grouped in a submenu named "DEVONthink
			Pro".</paragraph>
			<list>
				<item name="Copy Selection to Current Group">Copies the selected
				text to the selected or frontmost group in ${software}.</item>
				<item name="Copy Selection to Incoming">Copies the selected text
				and creates a new plain text document in a top-level group named
				"Incoming". If this group doesn't exists, the script creates
				it.</item>
				<item name="Copy Selection to ...">Copies the selected text and
				shows a group selector that lets you choose the group where the new
				document is filed into.</item>
				<item name="Link to current document">Creates a link to the
				frontmost document (e.g. a PowerPoint presentation or an Excel
				spreadsheet) in the currently open ${software} database. Handy when
				you're working on a document and quickly want to place a reference
				to it in ${software}.</item>
			</list>
		</subsection>
	</section>
	<section name="Triggered Scripts" id="triggered" edition_le="no" edition_pe="no">
		<paragraph>Triggered scripts are AppleScripts that you attach to an item in
		${software}, a group or document, and that are executed each time you display this
		item, e.g. by selecting it in "Horizontal Split" or "Vertical Split" view. Items
		with attached triggered scripts show an AppleScript icon after their
		name.</paragraph>
		<paragraph>Using triggered scripts, you can bring your contents "to life" and let
		them act intelligently on various parameters. To demonstrate this, ${software}
		comes with a couple of 
		<reference chapter="scripts" section="scriptsmenu">pre-made triggered
		scripts</reference>in the internal script menu that for example create "smart
		groups", download items from RSS feeds and mark items that you have already read.
		Other examples for triggered scripts can be found in our 
		<reference chapter="scripts" section="examples">"Example Scripts
		package",</reference>downloadable from our 
		<link href="http://www.devon-technologies.com/download">web
		site.</link></paragraph>
		<subsection name="Attaching a triggered script" id="triggered_attaching">
			<paragraph>Besides creating scripts that attach themselves to an item, you
			attach them manually by doing the following:</paragraph>
			<list>
				<item>Select the document you want to attach a script to.</item>
				<item>Open the 
				<reference chapter="windows" section="info">"Info"
				panel</reference>
				<reference chapter="menus" section="tools">("Tools &gt; Show
				Info...").</reference></item>
				<item>Click "Select..." next to the Script field and select the
				script to attach.</item>
			</list>
		</subsection>
		<subsection name="Removing a triggered script" id="triggered_removing">
			<paragraph>To remove a triggered script from an item, do the
			following:</paragraph>
			<list>
				<item>Select the item you want to remove the triggered script
				from.</item>
				<item>Open the 
				<reference chapter="windows" section="info">"Info"
				panel</reference>
				<reference chapter="menus" section="tools">("Tools &gt; Show
				Info...").</reference></item>
				<item>Select the contents of the Script field and delete it.</item>
			</list>
		</subsection>
	</section>
	<section name="Additional Scripts" id="additions" edition_le="no" edition_pe="no">
		<subsection name="Droplets" id="additions_droplets">
			<paragraph>Droplet are little AppleScript applications that allow you to
			run actions based on files or folders dropped on them. You can create them
			easily using the AppleScript editor; some useful examples already come with
			${software} on the disk image in "Scripts/Droplets". Basically, they do
			what their name suggests:</paragraph>
			<list>
				<item name="Import AppleWorks Droplet">Converts one or more dropped
				AppleWorks text, painting, drawing or spreadsheet documents to RTF,
				TIFF, PICT or TSV and import them into ${software}. Notes: This
				script requires AppleWorks 6. Turn off the "Old version" warning in
				the preferences of AppleWorks if you're going to convert older
				AppleWorks or ClarisWorks documents. In addition, the translators
				used by Apple to convert paintings and drawings are quite instable
				(and unlikely to get fixed as Apple concentrates on 
				<link href="http://www.apple.com/iwork">iWork</link>now).</item>
				<item name="Import Droplet">Imports files and folders dropped onto
				it.</item>
				<item name="Import PDF as Text Droplet">Imports PDFs (or folders
				containing PDFs) and immediately converts them to rich text.</item>
				<item name="Import Unstyled Droplet">Imports files and folders
				while removing any formatting from the imported documents.</item>
				<item name="Import Index Droplet">Indexes files and folders dropped
				onto it.</item>
			</list>
			<paragraph name="Using Droplets">Place a droplet anywhere you like and
			optionally drag it to the Dock to have it handy. Then, drag the files and
			folders you want the droplet to act on onto its icon in the Finder or the
			Dock.</paragraph>
		</subsection>
		<subsection name="Finder Plugins" id="additions_finderplugins">
			<paragraph>Using Automator, it's possible to add workflows as new commands
			to the Finder contextual menu. These workflows appear in the "Automator"
			submenu of the contextual menu in the Finder, and using "Create workflow"
			you can create and add your own workflows as well.</paragraph>
			<paragraph>${software} comes with one workflow for adding selected items to
			the currently open database pre-made as a Finder plugin. Install it using
			"Help &gt; Install Add-ons...", check "Finder Plugins" and click "Install".
			
			<reference chapter="scripts" section="automator" /></paragraph>
		</subsection>
		<subsection name="Folder Actions" id="additions_folderactions">
			<paragraph>Folder Actions are scripts that you can attach to folders in the
			file system and that act on all items you add to these "hot folders".
			${software} comes with three folder action scripts (located in
			"Scripts/Folder Actions") on the ${software} disk image.</paragraph>
			<note>It's recommended to copy all folder action scripts to the directory
			"/Library/Scripts/Folder Action Scripts".</note>
			<paragraph>The three scripts,</paragraph>
			<list>
				<item>Action Import</item>
				<item>Action Index</item>
			</list>
			<paragraph>do what their names suggest: import, index or link folders or
			files that you drop into a folder to that they're attached.</paragraph>
			<paragraph name="Attaching a Folder Action">To attach a folder action
			script to a folder, do the following:</paragraph>
			<list>
				<item>Control/right-click the folder.</item>
				<item>Select "Attach a Folder Action..." from the contextual
				menu.</item>
				<item>Select the folder action script you want to attach and click
				"Choose".</item>
			</list>
			<paragraph name="Manage Folder Actions">To manage all your folder actions,
			control/right-click a folder and choose "Configure Folder Actions" from the
			contextual menu. Use the "Folder Actions Setup" utility to see which
			folders have scripts attached and to remove folder actions from
			folders.</paragraph>
		</subsection>
		<subsection name="Mail" id="additions_mail">
			<paragraph>The script "Mail Rule Action Import" imports all the e-mails
			that the mail rule acts on to the currently open database.</paragraph>
			<paragraph>To use this script, do the following</paragraph>
			<list>
				<item>Open the folder "Scripts/Mail" on the ${software} disk
				image.</item>
				<item>Put the script anywhere on your hard disk.</item>
				<item>Create a new rule in the preferences window of Apple
				Mail.</item>
				<item>Define your criteria.</item>
				<item>Add the action "Execute Script"</item>
				<item>Select the script "Mail Rule Action Import".</item>
			</list>
		</subsection>
		<subsection name="PDF Services" id="additions_pdfservices">
			<paragraph>Using PDF Services, you can add your own actions to the "PDF"
			button of the print dialog windows in any Mac OS X application. By using
			scripts, this enables you to "print" any document from whatever application
			you like directly into the ${software} database and store the document as
			PDF.</paragraph>
			<note>This requires an installed printer to work properly!</note>
			<paragraph name="Installation">To install the scripts, select "Help &gt;
			Install Add-ons…" and check "PDF Services Scripts" in the dialog window.
			Then click "Install"</paragraph>
			<paragraph name="Printing to Your Database">To "print" a document to
			${software}, open it in its creator application. Then, do the
			following:"</paragraph>
			<list>
				<item>Select "File &amp; Print..."</item>
				<item>In the appearing print dialog window, click the "PDF" button
				at the lower left corner and select "Save to DEVONthink Pro" or
				"Save to Printed" from the pop-up menu.</item>
				<item>Then, select the destination group for the document and click
				"OK".</item>
			</list>
			<paragraph>The difference between these two scripts is that "Save to
			DEVONthink Pro" asks you for a destination group, "Save to Printed" always
			saves the created PDF to a group named "Printed", located on the top level
			of the database.</paragraph>
		</subsection>
		<subsection name="Workspaces" id="additions_workspaces">
			<paragraph>The scripts allow you to create different workspace sets and
			switch between them. A workspace contains references to open windows and
			switching between sets re-opens all windows stored in it. Use workspaces
			e.g. for different sets of documents for each of your projects.</paragraph>
			<paragraph>Workspaces are stored in a group named "_Workspaces_" in the top
			level of the currently open database. If this group doesn't exists, the
			script "New Workspace" will create it automatically.</paragraph>
			<list>
				<item name="New Workspace">Create a new group inside the
				"_Workspaces_" group and places replicants of all records that are
				currently opened in document/group windows into this new group. In
				addition this script will create the "_Workspaces_" group at the
				top level of the database if it does not exist already.</item>
				<item name="Open Workspace">Re-opens all windows "saved" in a
				workspace.</item>
				<item name="Add to Workspace">Adds the frontmost window to a
				workspace.</item>
				<item name="Delete Workspace">Deletes a workspace. The original
				records will not be touched, only the replicants in the
				"_Workspaces_" group.</item>
			</list>
			<paragraph>These scripts are not by default available through ${software}'s
			script menu. If you want to have these scripts at hand, copy the complete
			"Workspaces" folder from "Scripts/Workspaces" on the ${software} disk image
			into "~/Library/Application Support/DEVONthink Pro".</paragraph>
			<note>Thanks to Rudi Grams, Thailand, for offering these scripts to the
			public!</note>
		</subsection>
	</section>
	<section name="More Examples" id="examples" edition_le="no" edition_pe="no">
		<paragraph>You can also download some more 
		<link href="http://www.devon-technologies.com/download">example scripts</link>from
		our web site. Some of these scripts do things that have already been implemented as
		"real" commands in ${software}, others are functions you seldom use. All of them
		are more of an example character but can also be of real use.</paragraph>
		<list>
			<item name="Copy URLs-to-Paths">Copies the contents of the URL field of the
			selected contents to the Path fields and then empties the URL field.</item>
			<item name="Create Contacts">Copies all entries of the Mac OS X Address
			Book to ${software} (same as 
			<reference chapter="menus" section="file">"File &gt; Import &gt;
			Addressbook").</reference></item>
			<item name="Export to iPod">Exports selected documents as notes to an
			attached iPod (3rd generation or later) (same as 
			<reference chapter="menus" section="file">"File &gt; Export &gt; to
			iPod").</reference></item>
			<item name="Export to OPML">Exports selected documents as OPML file (same
			as 
			<reference chapter="menus" section="file">"File &gt; Export &gt; as
			Outliner Processor Markup Language").</reference></item>
			<item name="Fancy Text">Demonstrates some of the rich text scripting
			capabilities of ${software}.</item>
			<item name="Latest Macintosh News (Internal)">Downloads the latest news
			from a couple of RSS feeds and stores them as HTML files in the database.
			To each document it attaches a triggered script that changes the label when
			it is displayed for the first time ("marked read").</item>
			<item name="Latest Macintosh News (Linked)">Downloads the latest news from
			a couple of RSS feeds and stores links to them in the database. To each
			document it attaches a triggered script that changes the label when it is
			displayed for the first time ("marked read").</item>
			<item name="Latest Macintosh News (One Page)">Downloads the latest news
			from a couple of RSS feeds and stores them as one long HTML page in the
			database.</item>
			<item name="Merge">Merges multiple selected document to one long document
			(same as 
			<reference chapter="menus" section="data">"Data &gt;
			Merge").</reference></item>
			<item name="Move to Done">Moves the selected item(s) to the group "Done" in
			the top level of the database.</item>
			<item name="Open In PhotoStickies">Opens selected images in 
			<link href="http://www.devon-technologies.com/products/shareware">
			PhotoStickies.</link></item>
			<item name="Open In Preview">Opens selected images in Preview.</item>
			<item name="Smart Group">Triggered script that demonstrates how to use the
			search and replicate commands to create a smart group.</item>
			<item name="Synchronize">Triggered script that synchronizes the item it is
			attached to each time it is viewed. Can be used to keep a group always
			sync'ed with its counterpart in the file system.</item>
		</list>
	</section>
	<section name="Automator" id="automator" edition_le="no" edition_pe="no">
		<paragraph>${software} also comes with a bundle of integrated Automator actions
		that you can use to create your own Automator workflows.</paragraph>
		<paragraph>To see which actions ${software} provides, open Automator and select
		"${software}" in the applications list on the left hand side. Automator
		automatically displays all actions contained in the application. Select any action
		to show a short description about what the action does.</paragraph>
		<note>Cannot find the Automator action you need for your workflow? 
		<link href="http://www.devon-technologies.com/about/contact.html">We're open to
		suggestions!</link></note>
		<subsection name="Overview" id="automator_overview">
			<paragraph>We have created some workflow examples that can show you how to
			use Automator and ${software} together. This document will explain what the
			workflow examples are supposed to do and how you can adapt them for your
			situation. The examples are presented here are grouped around common
			functionality.</paragraph>
			<note>All examples have been configured for the ${software} Tutorial
			database (Download Tutorial). You will need to change file paths for your
			computer. You may incorporate sample code from these examples into your
			workflows without restriction, although the sample code has been provided
			"as is" and the responsibility for its operation is completely
			yours.</note>
		</subsection>
		<subsection name="File Management" id="automator_filemanagement">
			<paragraph>Managing files with ${software} is one of the great features.
			Here are different ways to work with the information in the
			database.</paragraph>
			<paragraph name="Move Existing Files">You have a folder with files that you
			think are in control by ${software}, but you want to move the files that
			are guaranteed to be found in the database to a different folder, let's say
			"Archive". This workflow will solve this problem for you. For the given
			files/directories, it will find all files and ask the database if items
			exist with these paths. For the ones that are found to exist move these to
			a specified folder.</paragraph>
			<note>The exact locations have not been defined in this workflow, that is
			up to you. ${software} will keep track of the moved files, so you don't
			have to change anything in the database.</note>
			<paragraph>To improve your workflow, specify a specific database to use by
			prepending the "Filter Items" action with a "Open Database" action. In
			general, it's a good idea to specify the database a workflow has to act
			on.</paragraph>
			<paragraph name="Add and Move Missing Files">Find out what files are not in
			the database by changing the value in the "Filter Items" to "Missing" in
			the previous workflow. Then we "Move Finder Items" in place so the next
			time we don't have to wonder if we missed any files. These files will be
			sent to the "Add Items to Current Group" action after setting the
			destination group, this will index the files into the database.</paragraph>
			<paragraph>To improve the workflow, specify a specific database to use by
			prepending the "Filter Items" action with a "Open Database" action. In
			general, it's a good idea to specify the database a workflow has to act
			on.</paragraph>
			<paragraph name="Start Workday">This workflow is something you'd start
			every day when you're ready for work. It is rather complicated but really
			shows off what you can do. Let's go through the steps:</paragraph>
			<list>
				<item name="1-2">We create the "Today: To Do" group in the
				${software} Tutorial database. This way we can be sure that the
				next step has a group to work on.</item>
				<item name="3">Then we run another workflow: Clean Today's To Do.
				Here we completely clean the contents of the "Today: To Do" group.
				By the way you may want to switch off the confirmation to delete
				every record in step 4 of this workflow, as long as you don't add
				items by hand to this group!</item>
				<item name="4">Here you can specify the different records
				throughout your database you're working on.</item>
				<item name="5">We only get the records that we're not marked as
				ready (Unchecked).</item>
				<item name="6-7">These are replicated to "Today: To Do" list. This
				will also open a new window with the items you want to work on
				today.</item>
				<item name="8">Get every record including the ones in
				subgroups.</item>
				<item name="9">Get the file paths from these records.</item>
				<item name="10">Open the external files in the Finder. You're ready
				to start working!</item>
			</list>
			<paragraph name="End Workday">At the end of your day, you'd like to make
			sure that the database is updated with the modified contents of the files
			you've been working on. That's the goal of this workflow. It synchronises
			every record in your "Today: To Do" group.</paragraph>
			<paragraph name="Copy Checked Records to iPod Notes">Whenever you feel like
			showing of to your colleagues that you have the coolest gadgets and
			software, you can use this workflow to get the text of the finished work in
			your To Do list and send it to your iPod. The order in which your notes
			will appear depends on the sort order of the records in the "Today: To Do"
			window.</paragraph>
		</subsection>
		<subsection name="Web Management" id="automator_webmanagement">
			<paragraph>Dealing with the web is where ${software} really shines. Here
			are a few workflows that help you manage the information you're gathering
			form the internet.</paragraph>
			<paragraph name="Capture Safari Page">Another take on getting information
			from Safari. If you save this example as an application and put it into
			your Dock, you can very easily get the information from the current
			web-page in Safari into your database. This is because the "Add Items to
			Current Group" will actually download the given URL so that its contents
			can be made available for searching.</paragraph>
			<paragraph name="Convert URLs to Webarchive">For this workflow you'll need
			a copy of another of our useful products: DEVONagent. Because DEVONagent
			makes it very easy to get access to a webarchive from a script, unlike
			Safari. It also shows how you can mix arbitrary AppleScript into an action
			(although in the next release of DEVONagent, this will most certainly be
			replaced by an action, stay tuned!). Let's go through the
			steps:</paragraph>
			<list>
				<item name="1-2">You get a nice informational message that you
				should discard when you change this example for your purposes. Make
				sure to select the records with URLs that you want to replace
				inside ${software}.</item>
				<item name="3">Retrieve the URL from the record selection.</item>
				<item name="4">We open the URLs in DEVONagent 2. Note that we open
				the URLs in tabs. Only one window will be open this way, this will
				cause less clutter on your screen.</item>
				<item name="5">Then we export these pages to a webarchive, as
				temporary files.</item>
				<item name="6">Back in ${software}, we create a "Converted
				Webpages" group.</item>
				<item name="7">Here we import the files. Note that we import them
				because we selected "Use temporary files instead" in step 5,
				${software} will copy the files to the database file folder for its
				own safe keeping.</item>
			</list>
			<paragraph name="Gather Information from Safari">The next two workflows are
			not so good for our bottom line, but nevertheless we will present these
			free of charge! The first in the series is a script that gets all the links
			(within the domain of the starting page) from Safari's open web pages and
			puts these into a special group called "Temporary Safari Links". For each
			entry in this group, you can see the state. The contents will be indexed
			(so loading these may take a while).</paragraph>
			<paragraph>Now you can go and do some searching for information you want.
			For the records in this group that match your criteria, you will set the
			state to "Checked".</paragraph>
			<paragraph name="Store Information from Safari">The second and last
			workflow in this series will clear up the mess we made. It gathers all the
			checked records and asks to move these to a group you specify (note that
			for this action we specified that the action has to be shown).</paragraph>
			<paragraph>Also, take a look at step 8, here we have to "Ignore Result from
			Previous Action" since we don't want you to delete the work that you spend
			so much time on! The remaining records in the temporary group will then be
			deleted.</paragraph>
			<paragraph>Now, why are these two workflows bad for our bottom line?
			Because they compete with DEVONagent. Although, truth be told, DEVONagent
			does a much better job at this then we can emulate with a couple of
			Automator workflows.</paragraph>
		</subsection>
		<subsection name="Other Workflows" id="automator_otherworkflows">
			<paragraph>Of course, Automator workflows can also be used to manipulate
			items in the database.</paragraph>
			<paragraph name="Set Attributes Recursively">A simple workflow that, when
			saved as an application, deserves a place in the Scripts menu. It is
			relatively simple:</paragraph>
			<list>
				<item>Get the record selection from the ${software}.</item>
				<item>If the selection contains groups, recursively add all records
				contained in these.</item>
				<item>Set the record attributes but make sure to make this visible
				when running so you can change different attributes when you run
				it. This is especially important when you save the workflow as an
				application.</item>
			</list>
			<paragraph name="Add in Finder">Save this workflow as a Finder plugin, then
			you can import a file selection from the Finder into a group that you
			select in an open database. You should remove the first action and name it
			"Add to DEVONthink Pro...". Then you will see it in the Finder's contextual
			menu under "Automator &gt; ...".</paragraph>
		</subsection>
		<note>Now, why are these two workflows bad for our bottom line? Because they
		compete with DEVONagent. Although, truth be told, DEVONagent does a much better job
		at this than we can emulate with a couple of Automator workflows.</note>
	</section>
</chapter>
