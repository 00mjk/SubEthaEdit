<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE syntax SYSTEM "syntax.dtd">
<syntax>
    <head>
        <name>Wiki</name>
        <charsintokens><![CDATA[_0987654321abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ@]]></charsintokens> 
    </head>

    <states>
    
        <default id="Base" color="#000" inverted-color="#fff" scope="meta.default">

			<import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>

			<state id="Bold" color="#000" font-weight="bold" scope="markup.bold">
				<begin><regex>\*\*</regex></begin>
				<end><regex>\*\*</regex></end>
				<state id="Bold Italic" color="#000" font-weight="bold" font-style="italic" scope="markup.italicbold">
					<begin><regex>\/\/</regex></begin>
					<end><regex>\/\/</regex></end>
			   </state>
			</state>
	
			<state id="Italic" color="#000" font-style="italic" scope="markup.italic">
				<begin><regex>\/\/</regex></begin>
				<end><regex>(?&lt;!p:|s:)\/\/|[\r\n]</regex></end>
				<state id="Italic Bold" color="#000" font-weight="bold" font-style="italic" scope="markup.italicbold">
					<begin><regex>\*\*</regex></begin>
					<end><regex>\*\*</regex></end>
				</state>
		   </state>


      <import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>

			<keywords id="Horizontal Line" color="#000" font-weight="bold" scope="markup.other.line">
				<regex>^(----[-]*)</regex>
			</keywords>

	
			<state id="External Link" color="#00a" font-weight="normal" scope="meta.link">
				<begin><regex>\[(?=\[)</regex></begin>
				<end><regex>\]\]|[\r\n]</regex></end>
					<state id="URL Portion" scope="meta.link.portion">
						<begin><regex>\[</regex></begin>
						<end><regex>(?:.(?=\]\]|\|)|[\r\n])</regex></end>
						<import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>
					</state>
			</state>

			<state id="Unordered List" color="#683821" scope="markup.list.unnumbered">
				<begin><regex>^  +\*</regex></begin>
				<end><regex>[\r\n]</regex></end>
				
				<import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>
				
				<state-link state="External Link"/>
				<state-link state="Bold"/>
				<state-link state="Italic"/>
			</state>

			<state id="Ordered List" color="#7a4022" scope="markup.list.numbered">
				<begin><regex>^  +\-</regex></begin>
				<end><regex>[\r\n]</regex></end>
				
				<import mode="Base" state="EmailAndURLContainerState" keywords-only="yes"/>
				
				<state-link state="External Link"/>
				<state-link state="Bold"/>
				<state-link state="Italic"/>
			</state>

			<state id="Quoted Odd Levels" color="#7b1e20" scope="markup.quote.odd">
				<begin><regex>^&gt;(?:&gt;&gt;)*?(?!&gt;)</regex></begin>
				<end><regex>[\r\n]</regex></end>
				<import/>
			</state>

			<state id="Quoted Even Levels" color="#1b5414" scope="markup.quote.even">
				<begin><regex>^(?:&gt;&gt;)+(?!&gt;)</regex></begin>
				<end><regex>[\r\n]</regex></end>
				<import/>
			</state>

	
			<state id="Footnotes" color="#236e25" scope="markup.other.footnote">
				<begin><regex>\((?=\()</regex></begin>
				<end><regex>(?&lt;=\))\)</regex></end>
			</state>
	
	
			<state id="Headline Level 1" color="#881350" font-weight="bold" scope="markup.heading.1">
				<begin><regex>^======</regex></begin>
				<end><regex>======</regex></end>
			</state>
	
			<state id="Headline Level 2" color="#970058" font-weight="bold" scope="markup.heading.2">
				<begin><regex>^=====</regex></begin>
				<end><regex>=====</regex></end>
			</state>
	
			<state id="Headline Level 3" color="#a70062" font-weight="bold" scope="markup.heading.3">
				<begin><regex>^====</regex></begin>
				<end><regex>====</regex></end>
			</state>
	
			<state id="Headline Level 4" color="#b20068" font-weight="bold" scope="markup.heading.4">
				<begin><regex>^===</regex></begin>
				<end><regex>===</regex></end>
			</state>
	
			<state id="Headline Level 5" color="#be006f" font-weight="bold" scope="markup.heading.5">
				<begin><regex>^==</regex></begin>
				<end><regex>==</regex></end>
			</state>

			<state id="Indented Verbatim" color="#4b4b4b" scope="markup.raw.indented">
				<begin><regex>^  (?![\*\-])</regex></begin>
				<end><regex>(?:\r?(?:\n|\r))</regex></end>
			</state>

			<state id="Code Verbatim" color="#4b4b4b" foldable="yes" scope="markup.raw.code">
				<begin><regex>&lt;code[^&gt;]*&gt;</regex></begin>
				<end><regex>&lt;/code&gt;</regex></end>
			</state>

			<state id="File Verbatim" color="#4b4b4b" font-weight="bold" foldable="yes" scope="structured.reference">
				<begin><regex>&lt;file[^&gt;]*&gt;</regex></begin>
				<end><regex>&lt;/file&gt;</regex></end>
			</state>

			<state id="nowiki" color="#4b4b4b" font-weight="bold" foldable="yes" scope="meta.preprocessor.nowiki">
				<begin><regex>&lt;nowiki[^&gt;]*&gt;</regex></begin>
				<end><regex>&lt;/nowiki&gt;</regex></end>
			</state>

			<state id="nowiki %%" color="#4b4b4b" font-weight="bold" foldable="yes" scope="meta.preprocessor.nowiki">
				<begin><regex>%%</regex></begin>
				<end><regex>%%</regex></end>
			</state>
	
        </default>
    </states>
</syntax>
